<app-shared-layout 
  title="Tournament Matches" 
  icon="bi-trophy"
  [loading]="loading" 
  loadingText="Loading matches..."
  [showEmptyState]="!loading && matches.length === 0"
  emptyText="No matches found. Create your first match!"
  emptyIcon="bi-trophy"
  emptyActionText="Create Match"
  emptyActionIcon="bi-plus-lg"
  [actions]="headerActions"
  (emptyAction)="openCreateModal()">
  
  <div *ngIf="matches.length > 0" class="row">
      <div *ngFor="let match of matches" class="col-md-6 col-lg-4 col-xl-3">
        <div class="mb-2 shadow-sm p-2 border">
          <div class="match-header position-relative">
            <h6>Round {{ match.round }} - Position {{ match.position }}</h6>
    
            <div class="btn-group btn-group-sm position-absolute top-0 end-0">
              <button class="btn btn-outline-secondary" (click)="openManageTeamsModal(match)" title="Manage teams">
                <i class="bi bi-gear"></i>
              </button>
              <button class="btn btn-outline-primary" (click)="openEditModal(match)" title="Edit match">
                <i class="bi bi-pencil"></i>
              </button>
              <button class="btn btn-outline-danger" (click)="deleteMatch(match.id!)" title="Delete match">
                <i class="bi bi-trash"></i>
              </button>
            </div>
          </div>
          
          <div class="d-flex justify-content-between align-items-center">
            <div class="bg-warning col text-center m-2 rounded fs-6 py-1">
              @if(match.team1?.name){
                <i class="bi bi-people-fill"></i>
                {{match.team1?.name}}
              }@else {
                <i class="bi bi-question-lg"></i>
              }
            </div>
            <div class="fw-bold fs-6 text-danger" style="rotate: -20deg;"><i class="bi bi-amd"></i></div>
            <div class="bg-warning col text-center m-2 rounded fs-6 py-1">
              @if(match.team2?.name){
                <i class="bi bi-people-fill"></i>
                {{match.team2?.name}}
              }@else {
                <i class="bi bi-question-lg"></i>
              }
            </div>
          </div>
          
          <div class="match-info d-flex align-items-center w-100 mt-2">
            <div class="badge fw-normal fs-6 me-auto" [class]="getStatusBadgeClass(match.status)">{{ match.status | titlecase}}</div>
            <div *ngIf="match.scheduledDate" class="badge text-bg-secondary fw-normal fs-6" [class.ms-auto]="match.status !== 'completed'" [class.mx-auto]="match.status === 'completed'">
              <i class="bi bi-calendar3 me-1"></i> {{ getFormattedDate(match.scheduledDate) }}
            </div>          
            <ng-container *ngIf="match.status === 'completed'">
              <div *ngIf="match.winner" class="badge text-bg-success fw-normal fs-6" [class.ms-auto]="match.winner">
                <i class="bi bi-trophy-fill me-1"></i> {{ match.winner.name }}
              </div>
            </ng-container>
  
          </div>
          
        </div>
      </div>
  </div>
  
</app-shared-layout>

<app-create-match-modal
  [show]="showCreateModal"
  (closed)="closeModals()"
  (created)="createMatch($event)">
</app-create-match-modal>

<app-edit-match-modal
  [show]="showEditModal"
  [match]="selectedMatch"
  [availableTeams]="getMatchTeamsForEdit()"
  (closed)="closeModals()"
  (updated)="updateMatch($event)">
</app-edit-match-modal>

<app-manage-teams-modal
  [show]="showManageTeamsModal"
  [availableTeams]="getAvailableTeamsForMatch()"
  [selectedTeams]="selectedTeams"
  (closed)="closeModals()"
  (teamsUpdated)="saveMatchTeams($event)">
</app-manage-teams-modal>